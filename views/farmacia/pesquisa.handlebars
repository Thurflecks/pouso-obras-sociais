<input type="text" id="busca" placeholder="Buscar produto..." />

<ul id="resultados"></ul>

<script>
    const inputBusca = document.getElementById('busca');
    const listaResultados = document.getElementById('resultados');

    inputBusca.addEventListener('input', async () => {
        const termo = inputBusca.value;

        if (termo.length === 0) {
            listaResultados.innerHTML = '';
            return;
        }

        if (termo.length >= 3) {
            try {
                const resposta = await fetch('/admin/farmacia/medicamentos/search', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ termo })
                });
                const produtos = await resposta.json();

                listaResultados.innerHTML = '';
                if (produtos.length === 0) {
                    listaResultados.innerHTML = '<li>Nenhum produto encontrado</li>';
                } else {
                    produtos.forEach(produto => {
                        const li = document.createElement('li');
                        const a = document.createElement('a');
                        a.href = `/admin/farmacia/medicamentos/add/${produto.id}`;
                        a.textContent = produto.NOME_PRODUTO;
                        li.appendChild(a);
                        listaResultados.appendChild(li);
                    });
                }
            } catch (erro) {
                console.error('Erro ao buscar produtos:', erro);
            }
        }
    });
</script>